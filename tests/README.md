# 税務書類リネームシステム v5.0 テストスイート

このディレクトリには、システムの動作確認と受け入れテスト用のスクリプトが含まれています。

## 🧪 テストスクリプト一覧

### 1. スモークテスト (`smoke_test.py`)
**目的**: 基本的なシステムコンポーネントの動作確認
**実行時間**: 約30秒
**対象**: 
- Tesseractリソース存在確認
- 分類エンジン初期化
- 基本的な分類機能
- ファイル操作
- 日本語エンコーディング

```bash
python smoke_test.py
```

### 2. 受け入れテスト (`acceptance_test.py`)
**目的**: 実運用に向けた包括的な機能確認
**実行時間**: 約1-2分
**対象**:
- 命名規則（XXXX_書類名_YYMM.pdf）
- 自治体連番システム
- AND条件分類ロジック
- エラーハンドリング

```bash
python acceptance_test.py
```

### 3. 統合テストランナー (`run_all_tests.py`)
**目的**: 全テストの順次実行
**実行時間**: 約2-3分

```bash
python run_all_tests.py
```

## 📁 サンプルファイル

### `sample_pdfs/`
受け入れテスト用のサンプルPDFファイル置き場
- 詳細は `sample_pdfs/README.md` を参照
- 実際のPDFファイルは別途準備が必要

## 🚀 テスト実行方法

### クイックテスト（推奨）
```bash
# v4.0ディレクトリから実行
cd v4.0
python tests/run_all_tests.py
```

### 個別テスト実行
```bash
# スモークテストのみ
python tests/smoke_test.py

# 受け入れテストのみ  
python tests/acceptance_test.py
```

## ✅ テスト合格基準

### スモークテスト
- [x] Tesseractリソース確認: PASS
- [x] Tesseract実行確認: PASS
- [x] ファイル操作テスト: PASS
- [x] 日本語エンコーディングテスト: PASS
- [x] 分類エンジン初期化: PASS
- [x] 基本分類テスト: PASS

### 受け入れテスト
- [x] 前提条件チェック: PASS
- [x] 命名規則テスト: PASS（XXXX_書類名_YYMM.pdf形式）
- [x] 自治体連番テスト: PASS（1001, 2011, 2021等の適切な番号）
- [x] AND条件ロジックテスト: PASS（複数キーワード同時マッチング）
- [x] エラーハンドリングテスト: PASS（未分類書類→9999番）

## 🔧 トラブルシュート

### 「Tesseractリソースが見つかりません」
**解決方法**: 
1. `resources/tesseract/README.md` を参照
2. 必要ファイルをダウンロード・配置
3. プレースホルダーファイル（*.placeholder）を削除

### 「分類結果が期待と違う」
**解決方法**:
1. デバッグモードでテスト実行
2. 入力テキストの内容を確認
3. AND条件設定を見直し

### 「ImportError」
**解決方法**:
1. v4.0ディレクトリから実行していることを確認
2. Python依存関係のインストール確認
3. sys.pathの設定確認

## 📊 テストレポート

### 自動生成レポート
受け入れテスト実行時に以下が自動生成されます：
- `acceptance_test_report_YYYYMMDD_HHMMSS.json` - 詳細結果（JSON形式）

### レポート内容
- テスト実行日時
- システム設定情報
- 各テストの詳細結果
- 成功率・サマリー情報

## 🎯 受け入れ判定

### 最低合格ライン
- **スモークテスト**: 100%合格必須
- **受け入れテスト**: 100%合格必須

### 本格運用判定基準
1. ✅ 全テストが100%合格
2. ✅ Tesseractリソースが正しく配置済み
3. ✅ 実際のPDFファイルでの動作確認完了
4. ✅ 想定される書類種別での分類・命名確認完了

## 🔄 継続的テスト

### 定期実行推奨
- システム変更時: 必須
- 月次: 定期確認
- 新しい書類種別追加時: 必須

### 拡張テスト
新しいテストケースを追加する場合：
1. `acceptance_test.py` にテストケース追加
2. 期待される結果を定義
3. テスト実行・確認

## 📞 サポート

テスト関連で問題が発生した場合：
1. エラーメッセージの詳細確認
2. システム要件の確認
3. 関連ドキュメントの参照
4. 必要に応じてシステム管理者に連絡