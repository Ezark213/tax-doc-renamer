# 税務書類リネームシステム 番号体系完全ガイド 📋

## 目次
1. [番号体系の基本](#番号体系の基本)
2. [各番号の詳細解説](#各番号の詳細解説)
3. [判定キーワード完全一覧](#判定キーワード完全一覧)
4. [連番ルールの仕組み](#連番ルールの仕組み)
5. [実際の処理例](#実際の処理例)

---

## 番号体系の基本

### 🎯 基本構造
```
XXXX_書類名_YYMM.pdf
└─┬─┘       └─┬──┘
  │           └─ 年月（例：2508 = 2025年8月）
  └─ 4桁の分類番号
```

### 📊 番号帯の意味
| 番号帯 | 分類 | 例 | 説明 |
|-------|------|----|----|
| **0000-0999** | 国税申告書類 | 0001, 0003 | 法人税・消費税以外の国税 |
| **1000-1999** | 都道府県税 | 1001, 1011 | 都道府県民税・事業税など |
| **2000-2999** | 市町村税 | 2001, 2011 | 市民税・住民税など |
| **3000-3999** | 消費税 | 3001, 3003 | 消費税・地方消費税 |
| **5000-5999** | 会計書類 | 5001, 5002 | 決算書・元帳など |
| **6000-6999** | 固定資産 | 6001, 6002 | 固定資産台帳など |
| **7000-7999** | 税区分 | 7001, 7002 | 税区分集計表 |
| **9999** | 未分類 | 9999 | 分類できなかった書類 |

---

## 各番号の詳細解説

### 🏛️ 国税関連（0000番台）

#### **0000_納付税額一覧表**
- **用途**: 各種税金の納付金額をまとめた一覧表
- **判定方法**: 最優先キーワード（優先度100）
- **必要キーワード**: 
  - 「納付税額一覧表」**かつ**「既納付額」の両方が必要
- **例**: `0000_納付税額一覧表_2508.pdf`

#### **0001_法人税及び地方法人税申告書**
- **用途**: 法人税の申告書本体
- **判定方法**: 最優先キーワード（優先度110）または通常ルール（優先度15）
- **最優先キーワード**:
  - 「事業年度分の法人税申告書」
  - 「控除した金額」
  - 「控除しきれなかった金額」
  - 「課税留保金額」
  - 「適用額明細書」
  - 「中間申告分の地方法人税額」
  - 「中間申告分の法人税額」
- **完全一致キーワード**:
  - 「法人税及び地方法人税申告書」
  - 「内国法人の確定申告」
  - 「内国法人の確定申告(青色)」
  - 「法人税申告書別表一」
  - 「申告書第一表」
  - 「税額控除超過額」
- **部分一致キーワード**:
  - 「法人税申告」「内国法人」「確定申告」「青色申告」「事業年度分」「税額控除」
- **除外キーワード**: 
  - 「添付資料」「資料」「別添」「参考」「イメージ添付」
- **例**: `0001_法人税及び地方法人税申告書_2508.pdf`

#### **0002_添付資料_法人税**
- **用途**: 法人税申告書に添付する資料
- **判定方法**: 通常ルール（優先度10）
- **完全一致キーワード**:
  - 「法人税 添付資料」
  - 「添付資料 法人税」
  - 「イメージ添付書類(法人税申告)」
  - 「イメージ添付書類 法人税」
  - 「添付書類 法人税」
- **除外キーワード**: 
  - 「消費税申告」「法人消費税」「消費税」
- **例**: `0002_添付資料_2508.pdf`

#### **0003_受信通知_法人税**
- **用途**: 法人税申告が受け付けられた通知
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「法人税 受信通知」
  - 「受信通知 法人税」
- **部分一致キーワード**:
  - 「受信通知」「国税電子申告」
- **除外キーワード**: 
  - 「消費税」「地方税」
- **例**: `0003_受信通知_2508.pdf`

#### **0004_納付情報_法人税**
- **用途**: 法人税の納付に関する情報
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「法人税 納付情報」
  - 「納付情報 法人税」
- **部分一致キーワード**:
  - 「納付情報」「納付書」「国税 納付」
- **除外キーワード**: 
  - 「消費税」「地方税」
- **例**: `0004_納付情報_2508.pdf`

---

### 🏢 都道府県税関連（1000番台）

#### **1001系列_都道府県民税・事業税・特別法人事業税**
- **基本番号**: 1001（1番目の都道府県）
- **連番**: 1011（2番目）、1021（3番目）、1031（4番目）、1041（5番目）
- **用途**: 都道府県に納める法人税
- **判定方法**: 通常ルール（優先度11）
- **完全一致キーワード**:
  - 「法人都道府県民税・事業税・特別法人事業税申告書」
  - 「法人事業税申告書」
  - 「都道府県民税申告書」
- **部分一致キーワード**:
  - 「都道府県民税」「法人事業税」「特別法人事業税」
  - 「道府県民税」「事業税」「県税事務所」
  - 「都税事務所」「年400万円以下」「年月日から年月日までの」
- **除外キーワード**: 
  - 「市町村」「市民税」「市役所」「町役場」「村役場」
- **例**: 
  - `1001_東京都_法人都道府県民税・事業税・特別法人事業税_2508.pdf`
  - `1011_愛知県_法人都道府県民税・事業税・特別法人事業税_2508.pdf`
  - `1021_福岡県_法人都道府県民税・事業税・特別法人事業税_2508.pdf`

#### **1003_受信通知_都道府県**
- **用途**: 都道府県税申告の受信通知
- **判定方法**: 通常ルール（優先度8）
- **完全一致キーワード**:
  - 「都道府県 受信通知」
- **部分一致キーワード**:
  - 「受信通知」「地方税電子申告」
- **除外キーワード**: 
  - 「市町村」「国税」
- **例**: `1003_受信通知_2508.pdf`

#### **1004_納付情報_都道府県**
- **用途**: 都道府県税の納付情報
- **判定方法**: 通常ルール（優先度8）
- **完全一致キーワード**:
  - 「都道府県 納付情報」
- **部分一致キーワード**:
  - 「納付情報」「地方税 納付」
- **除外キーワード**: 
  - 「市町村」「国税」
- **例**: `1004_納付情報_2508.pdf`

---

### 🏘️ 市町村税関連（2000番台）

#### **2001系列_法人市民税**
- **基本番号**: 2001（1番目の市町村）
- **連番**: 2011（2番目）、2021（3番目）、2031（4番目）、2041（5番目）
- **用途**: 市町村に納める法人市民税
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「法人市民税申告書」
  - 「市民税申告書」
- **部分一致キーワード**:
  - 「法人市民税」「市町村民税」
- **除外キーワード**: 
  - 「都道府県」「事業税」
- **例**: 
  - `2001_愛知県蒲郡市_法人市民税_2508.pdf`
  - `2011_福岡県福岡市_法人市民税_2508.pdf`

#### **2003系列_受信通知_市町村**
- **基本番号**: 2003（1番目の市町村）
- **連番**: 2013（2番目）、2023（3番目）、2033（4番目）、2043（5番目）
- **用途**: 市町村税申告の受信通知
- **判定方法**: 通常ルール（優先度8）
- **完全一致キーワード**:
  - 「市町村 受信通知」
- **部分一致キーワード**:
  - 「受信通知」「地方税電子申告」
- **除外キーワード**: 
  - 「都道府県」「国税」
- **例**: `2003_受信通知_2508.pdf`

#### **2004_納付情報_市町村**
- **用途**: 市町村税の納付情報
- **判定方法**: 通常ルール（優先度8）
- **完全一致キーワード**:
  - 「市町村 納付情報」
- **部分一致キーワード**:
  - 「納付情報」「地方税 納付」
- **除外キーワード**: 
  - 「都道府県」「国税」
- **例**: `2004_納付情報_2508.pdf`

---

### 💰 消費税関連（3000番台）

#### **3001_消費税及び地方消費税申告書**
- **用途**: 消費税の申告書本体
- **判定方法**: 最優先キーワード（優先度90）または通常ルール（優先度15）
- **最優先キーワード**:
  - 「課税期間分の消費税及び」
  - 「基準期間の」
  - 「現金主義会計の適用」
  - 「消費税及び地方消費税申告(一般・法人)」
  - 「消費税申告(一般・法人)」
- **完全一致キーワード**:
  - 「消費税申告書」
  - 「消費税及び地方消費税申告書」
  - 「消費税及び地方消費税申告(一般・法人)」
  - 「消費税申告(一般・法人)」
  - 「課税期間分の消費税及び」
  - 「基準期間の」
  - 「現金主義会計の適用」
- **部分一致キーワード**:
  - 「消費税申告」「地方消費税申告」「消費税申告書」「課税期間分」「基準期間」
- **除外キーワード**: 
  - 「添付資料」「イメージ添付」「資料」
- **例**: `3001_消費税及び地方消費税申告書_2508.pdf`

#### **3002_添付資料_消費税**
- **用途**: 消費税申告書の添付資料
- **判定方法**: 通常ルール（優先度10）
- **完全一致キーワード**:
  - 「消費税 添付資料」
  - 「添付資料 消費税」
  - 「イメージ添付書類(法人消費税申告)」
  - 「イメージ添付書類 消費税」
  - 「添付書類 消費税」
- **部分一致キーワード**:
  - 「添付資料」「消費税 資料」「イメージ添付」「添付書類」
- **除外キーワード**: 
  - 「消費税及び地方消費税申告」「消費税申告書」「申告(一般・法人)」「法人税申告」「内国法人」「確定申告」
- **例**: `3002_添付資料_2508.pdf`

#### **3003_受信通知_消費税**
- **用途**: 消費税申告の受信通知
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「消費税 受信通知」
  - 「受信通知 消費税」
- **部分一致キーワード**:
  - 「受信通知」「国税電子申告」
- **除外キーワード**: 
  - 「法人税」「地方税」
- **例**: `3003_受信通知_2508.pdf`

#### **3004_納付情報_消費税**
- **用途**: 消費税の納付情報
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「消費税 納付情報」
  - 「納付情報 消費税」
- **部分一致キーワード**:
  - 「納付情報」「納付書」
- **除外キーワード**: 
  - 「法人税」「地方税」
- **例**: `3004_納付情報_2508.pdf`

---

### 📚 会計書類（5000番台）

#### **5001_決算書**
- **用途**: 貸借対照表、損益計算書等の決算書類
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「決算書」「貸借対照表」「損益計算書」
- **部分一致キーワード**:
  - 「決算」「B/S」「P/L」
- **例**: `5001_決算書_2508.pdf`

#### **5002_総勘定元帳**
- **用途**: 会計の総勘定元帳
- **判定方法**: 最優先キーワード（優先度100、1ページ目のみ）または通常ルール（優先度15）
- **最優先キーワード**:
  - 「総勘定元帳」（1ページ目のみ適用）
- **完全一致キーワード**:
  - 「総勘定元帳」
- **部分一致キーワード**:
  - 「総勘定」「元帳」
- **除外キーワード**: 
  - 「補助元帳」「補助」
- **例**: `5002_総勘定元帳_2508.pdf`

#### **5003_補助元帳**
- **用途**: 会計の補助元帳
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「補助元帳」
- **部分一致キーワード**:
  - 「補助元帳」「補助」
- **除外キーワード**: 
  - 「総勘定」
- **例**: `5003_補助元帳_2508.pdf`

#### **5004_残高試算表**
- **用途**: 会計の残高試算表
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「残高試算表」「試算表」
- **部分一致キーワード**:
  - 「残高試算」「試算表」
- **例**: `5004_残高試算表_2508.pdf`

#### **5005_仕訳帳**
- **用途**: 会計の仕訳帳（PDF形式）
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「仕訳帳」
- **部分一致キーワード**:
  - 「仕訳」
- **例**: `5005_仕訳帳_2508.pdf`

#### **5006_仕訳データ**
- **用途**: 仕訳データ（CSV形式）
- **判定方法**: 通常ルール（優先度不明）
- **完全一致キーワード**:
  - 「A1:取引No」
- **例**: `5006_仕訳データ_2508.csv`

---

### 🏠 固定資産関連（6000番台）

#### **6001_固定資産台帳**
- **用途**: 固定資産の台帳
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「固定資産台帳」
- **部分一致キーワード**:
  - 「固定資産台帳」「資産台帳」
- **例**: `6001_固定資産台帳_2508.pdf`

#### **6002_一括償却資産明細表**
- **用途**: 一括償却資産の明細表
- **判定方法**: 最優先キーワード（優先度100）または通常ルール（優先度15）
- **最優先キーワード**:
  - 「一括償却資産明細表」
- **完全一致キーワード**:
  - 「一括償却資産明細表」
- **部分一致キーワード**:
  - 「一括償却」「償却資産明細」
- **除外キーワード**: 
  - 「少額」
- **例**: `6002_一括償却資産明細表_2508.pdf`

#### **6003_少額減価償却資産明細表**
- **用途**: 少額減価償却資産の明細表
- **判定方法**: 最優先キーワード（優先度100）または通常ルール（優先度15）
- **最優先キーワード**:
  - 「少額減価償却資産明細表」
- **完全一致キーワード**:
  - 「少額減価償却資産明細表」
- **部分一致キーワード**:
  - 「少額減価償却」「少額償却」
- **除外キーワード**: 
  - 「一括」
- **例**: `6003_少額減価償却資産明細表_2508.pdf`

---

### 📊 税区分関連（7000番台）

#### **7001_勘定科目別税区分集計表**
- **用途**: 勘定科目別の税区分集計表
- **判定方法**: 通常ルール（優先度10）
- **完全一致キーワード**:
  - 「勘定科目別税区分集計表」
- **部分一致キーワード**:
  - 「勘定科目別税区分」「勘定科目別」「科目別税区分」
- **例**: `7001_勘定科目別税区分集計表_2508.pdf`

#### **7002_税区分集計表**
- **用途**: 税区分の集計表（勘定科目別ではないもの）
- **判定方法**: 通常ルール（優先度9）
- **完全一致キーワード**:
  - 「税区分集計表」
- **部分一致キーワード**:
  - 「税区分集計」「区分集計」
- **除外キーワード**: 
  - 「勘定科目別」「科目別」（重要：勘定科目別を含む場合は除外）
- **例**: `7002_税区分集計表_2508.pdf`

---

### ❌ エラー処理

#### **9999_未分類**
- **用途**: システムが分類できなかった書類
- **判定方法**: 信頼度0.3未満の場合に自動設定
- **例**: `9999_未分類_2508.pdf`

---

## 連番ルールの仕組み

### 🎯 自治体連番の基本原理

#### **都道府県の連番**
```
入力順序 → 番号
1番目   → 1001
2番目   → 1011  
3番目   → 1021
4番目   → 1031
5番目   → 1041
```

#### **市町村の連番**
```
入力順序 → 番号
1番目   → 2001
2番目   → 2011
3番目   → 2021
4番目   → 2031
5番目   → 2041
```

#### **受信通知の連番（市町村のみ）**
```
入力順序 → 番号
1番目   → 2003
2番目   → 2013
3番目   → 2023
4番目   → 2033
5番目   → 2043
```

### 🚨 重要なルール

#### **東京都の特別制限**
- 東京都は**必ず1番目（セット1）**に入力する必要がある
- 他の位置に入力するとエラーになる
- 東京都には市町村分（2000番台）の書類は存在しない

#### **連番の計算方法**
```
基本番号 + (入力順序 - 1) × 10 = 最終番号

例：
1001 + (2 - 1) × 10 = 1011  （2番目の都道府県）
2001 + (3 - 1) × 10 = 2021  （3番目の市町村）
```

---

## 実際の処理例

### 📝 例1：複数自治体の書類処理

**入力設定**:
- セット1：東京都
- セット2：愛知県 蒲郡市  
- セット3：福岡県 福岡市

**結果**:
```
1001_東京都_法人都道府県民税・事業税・特別法人事業税_2508.pdf
1011_愛知県_法人都道府県民税・事業税・特別法人事業税_2508.pdf
1021_福岡県_法人都道府県民税・事業税・特別法人事業税_2508.pdf

2001_愛知県蒲郡市_法人市民税_2508.pdf
2011_福岡県福岡市_法人市民税_2508.pdf

2003_受信通知_2508.pdf  （蒲郡市分）
2013_受信通知_2508.pdf  （福岡市分）
```

### 📝 例2：判定キーワードによる分類

**テキスト内容**: 「事業年度分の法人税申告書」
**判定結果**: 最優先キーワード（優先度110）で即座に分類
**ファイル名**: `0001_法人税及び地方法人税申告書_2508.pdf`

**テキスト内容**: 「納付税額一覧表」と「既納付額」を含む
**判定結果**: 最優先キーワード（優先度100）で即座に分類  
**ファイル名**: `0000_納付税額一覧表_2508.pdf`

**テキスト内容**: 「受信通知」と「消費税」を含む
**判定結果**: 通常ルール（優先度9）でスコア計算
**ファイル名**: `3003_受信通知_2508.pdf`

### 📝 例3：除外キーワードによる除外

**テキスト内容**: 「法人税申告」と「消費税」を含む
**0003_受信通知_法人税**の判定: 除外キーワード「消費税」により除外
**3003_受信通知_消費税**の判定: 除外キーワード「法人税」により除外
**結果**: どちらも除外され、未分類になる可能性

---

## 🔍 スコア計算システムの詳細

### 📊 ポイント配点
- **完全一致キーワード**: 優先度 × 2ポイント
- **部分一致キーワード**: 優先度 × 1ポイント  
- **ファイル名キーワード**: 優先度 × 3ポイント（1.5倍）
- **除外キーワード**: 該当で即座にスコア = 0

### 📈 信頼度の計算
```
信頼度 = min(最高スコア / 15.0, 1.0)

例：
スコア45の場合 → 信頼度 = min(45/15, 1.0) = 1.0 (100%)
スコア10の場合 → 信頼度 = min(10/15, 1.0) = 0.67 (67%)
スコア4の場合  → 信頼度 = min(4/15, 1.0) = 0.27 (27%) → 未分類
```

---

## 🚨 よくある問題と対策

### 問題1：国税書類が未分類になる
**原因**: 除外キーワードが先に適用される
**対策**: 除外ロジックの見直し、最優先キーワードの追加

### 問題2：同じ書類が複数回生成される  
**原因**: 重複チェック機能の不足
**対策**: 既存ファイル名のチェック機能追加

### 問題3：東京都のエラー
**原因**: 東京都が1番目以外に入力されている
**対策**: 必ず東京都をセット1に入力する

---

## 📞 サポート情報

**システム**: 税務書類リネームシステム v4.0  
**GitHub**: https://github.com/Ezark213/tax-doc-renamer  
**更新日**: 2025年8月26日

このガイドは中学生でも理解できるよう、専門用語を避けて詳しく解説しました。
不明な点があれば、具体例を交えて質問してください。