# 税務書類リネームシステム v4.0 機能説明書

## システム概要
税務書類リネームシステムv4.0は、税務関連のPDFファイルやCSVファイルを自動的に分類・リネームするためのアプリケーションです。OCR（光学文字認識）技術を使用してファイル内容を解析し、適切な命名規則に従ってファイル名を変更します。

## 主な機能

### 1. ファイル処理機能
- **対応形式**: PDF、CSV
- **処理方法**: ドラッグ&ドロップまたはクリックでファイル選択
- **一括処理**: 複数ファイルの同時処理が可能

### 2. 自治体設定機能
システムは最大5つの自治体セットを設定可能で、各セットには以下を指定：
- **都道府県名**（例：東京都、愛知県、福岡県など）
- **市町村名**（例：蒲郡市、福岡市など）

### 3. 処理オプション
- **PDF自動分割**: 複数ページのPDFを自動的に分割
- **OCR強化モード**: 文字認識精度を向上させるモード

### 4. 年月設定
- **手動入力年月**: 処理対象の年月を指定（YYMM形式）
- 例：2508（令和7年8月）

## ファイル分類システム

画面に表示されているファイルから判断される分類パターン：

### A. 申告書類（0000番台）
- **納付税額一覧表**: `納付税額一覧表_20250818_1017.pdf`
- **確定申告書**: 法人税、消費税などの各種申告書
- **添付資料**: 申告書に添付する補助資料

### B. 都道府県関連書類（1000番台）
- **都道府県民税・事業税**: `メトローム_株式会社_東京都港税務事務所_250731.pdf`
- **特別法人事業税**: 都道府県税に関する申告書
- **入力順序による連番**: 1001, 1011, 1021, 1031, 1041

### C. 市町村関連書類（2000番台）  
- **法人市民税**: `メトローム_株式会社_蒲郡市役所_250731.pdf`
- **市町村民税**: 市区町村税に関する申告書
- **入力順序による連番**: 2001, 2011, 2021, 2031, 2041

### D. 消費税関連書類（3000番台）
- **消費税申告書**: `3002_添付資料_0605.pdf`
- **添付資料**: 消費税申告に必要な補助書類

## 自動リネーム機能

### リネーム規則
1. **書類種別コード_自治体名_書類種別名_処理日付.拡張子**
2. **例**:
   - `1011_愛知県_法人都道府県民税・事業税・特別法人事業税_20250818.pdf`
   - `2011_愛知県蒲郡市_法人市民税_20250818.pdf`
   - `3002_添付資料_20250818.pdf`

### 特殊処理
- **東京都制限**: 東京都は必ずセット1に設定（他のセットでの設定はエラー）
- **市町村除外**: 東京都設定時は市町村書類は生成されない
- **OCR対応**: 手書きや低品質PDFにも対応

## 操作手順

### 基本操作
1. **設定**: 右側パネルで自治体情報と年月を設定
2. **ファイル選択**: ドラッグ&ドロップまたはファイル選択ボタンを使用
3. **処理実行**: 「リネーム実行」または「分割実行」ボタンをクリック
4. **結果確認**: 処理完了後、リネーム済みファイルを確認

### 詳細設定
- **PDF自動分割**: 大きなPDFファイルを自動的に分割
- **OCR強化モード**: 文字認識精度を高める（処理時間は増加）

## ファイル例の解説

画面表示されているファイル群の分析：

### 申告関連ファイル
- `納付税額一覧表_20250818_1017.pdf` → 納付税額の一覧表
- `約款関連.pdf` → 契約約款などの関連書類
- `経常元年_20250818_1012.pdf` → 経常収支に関する申告書

### 自治体別申告書
- `メトローム_株式会社_東京都港税務事務所_250731.pdf` → 東京都への申告書
- `メトローム_株式会社_蒲郡市役所_250731.pdf` → 蒲郡市への申告書
- `メトローム_株式会社_愛知県東三河県税事務所_250721.pdf` → 愛知県への申告書

### 特別書類
- `住民票付与分事業税_20250818_1020.pdf` → 住民税関連の特別計算書
- `少額.pdf` → 少額減価償却資産関連
- `仕訳帳_20250818_1018.pdf` → 会計仕訳データ

## システムの利点

### 1. 効率化
- 手動リネーム作業の自動化
- 大量ファイルの一括処理
- OCRによる自動内容認識

### 2. 正確性
- 統一された命名規則
- 自治体情報の自動判定
- エラーチェック機能

### 3. 柔軟性
- 複数自治体の同時対応
- カスタムサポート設定
- 年月指定による期間管理

## 注意事項

### ファイル形式
- PDF、CSVファイルのみ対応
- 画像ファイル（JPG、PNGなど）は非対応

### 処理制限
- OCR処理には時間がかかる場合があります
- ファイルサイズが大きい場合は分割処理を推奨
- 手書き文字の認識精度には限界があります

### 設定注意点
- 東京都は必ずセット1に設定
- 同一自治体の重複設定は避ける
- 年月設定は処理対象期間に合わせる

---

**システム作成者**: Claude Code  
**バージョン**: v4.0  
**最終更新**: 2025年1月21日  
**対応OS**: Windows 10/11